<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Safety-First | 서울은 성범죄로부터 안전한 곳인가</title>
    <link rel="stylesheet" href="scripts/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin=""/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
  </head>
  <body>
    <div class="background">
      <svg id="background_sky" />
      <nav aria-label="Page navigation" id="buttons_as_the_moon_and_the_stars">
        <ul class="pagination">
          <li id="main"><a class=""><svg class="moon"></svg></a></li>
          <li id="index"><a><svg class="star"></svg></a></li>
          <li id="intro_demographic"><a><svg class="star"></svg></img></a></li>
          <li id="analysis"><a><svg class="star"></svg></a></li>
          <li id="map_vis"><a><svg class="star"></svg></a></li>
          <li id="conclusion"><a><svg class="star"></svg></a></li>
        </ul>
      </nav>
    </div>

    <div id="web_content">
      <table>
        <tr>
          <td id="main_view">
            <div class="container">
              <div class="section_header">
                <h1 class="section_title">서울은 성범죄로부터 안전한 곳일까</h1>
              </div>
              <div class="section_container">
                <svg class="section_slides">
                  <p class="section_text">첫 장</p>
                </svg>
              </div>
            </div>
          </td>

          <td id="index_view">
            <div class="container">
              <div class="section_header">
                <h1 class="section_title"></h1>
              </div>
              <div class="section_container">
                <svg class="section_slides">
                  <p class="section_text"></p>
                </svg>
              </div>
            </div>
          </td>

          <td id="intro_demographic_view">
            <div class="container">
              <div class="section_header">
                <h1 class="section_title">누가 얼만큼 안전할까?</h1>
              </div>
              <div class="section_container">
                <svg class="section_slides">
                  <section id="main-title">
                    <p>당신의 인적 사항 정보를 알려주세요.<br>
                      입력된 정보와 일치하는 <u>최근 3년간 일어난 성폭력 피해자</u> 숫자를 공개합니다.<br>
                    </p>
                    <h6>2014~ 2016년 서울시 성폭력 피해자 성별/연령 현황[데이터출처: 서울특별시 경찰청]</h6>
                  </section>

                  <section id="question-container">
                    <div id="question-gender">
                      <div class="question">
                        <div>1. 당신의 성별은?</div>
                        <div class="question-navi">
                          <span class="navi-current">성별</span> ➡ <span class="navi-none-age">연령</span>
                        </div>
                      </div>
                      <div class="image-selector">
                        <div class="selector-item" qtype="gender" value="여성">
                          <img src="./img/female_selected.png" alt="female">
                          <p>여성</p>
                        </div>
                        <div class="selector-item" qtype="gender" value="남성">
                          <img src="./img/male_selected.png" alt="male">
                          <p>남성</p>
                        </div>
                      </div>
                    </div>
                    <div id="question-age">
                      <div class="question">
                        <div>2. 당신의 연령은?</div>
                        <div class="question-navi">
                          <span class="navi-none-gender">성별</span> ➡ <span class="navi-current">연령</span>
                        </div>
                      </div>
                      <div class="image-selector-age">
                        <div class="selector-item" qtype="age" value="6세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>6세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="12세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>12세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="15세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>15세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="20세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>20세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="30세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>30세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="40세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>40세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="50세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>50세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="60세 이하">
                          <img src="./img/20_selected.png" alt="">
                          <p>60세 이하</p>
                        </div>
                        <div class="selector-item" qtype="age" value="60세 초과">
                          <img src="./img/20_selected.png" alt="">
                          <p>60세 초과</p>
                        </div>
                      </div>
                    </div>
                  </section>

                  <section id="result-container">
                    <div id="user-intro">
                      나는 <span id="gender-bc" class="breadcomb">성별</span> <span id="age-bc" class="breadcomb">연령</span> 입니다.
                    </div>
                    <div id="result-summary">
                      "당신과 같은 조건의 피해자는 <span id="victim">8780</span>명입니다"
                    </div>
                  </section>
                  <p>최근 3년간 성폭력 피해자 통계 <a href="#">더 알아보기</a></p>
                </svg>
              </div>
            </div>
          </td>

          <td id="analysis_view">
            <div class="container">
              <div class="section_header">
                <h1 class="section_title">About 성범죄</h1>
              </div>
              <div class="section_container">
                <svg class="section_slides">
                  <p class="section_text"></p>
                </svg>
              </div>
            </div>
          </td>

          <td id="map_vis_view">
            <div class="container">
              <div class="section_header">
                <h1 class="section_title">서울 안전 지도</h1>
              </div>
              <div class="section_container">
                <svg class="section_slides">
                  <div id="map"></div>
                  <div class="buttons">
                    <div class="btn-group" role="group" aria-label="navi-year">
                      <button id="year_drop" class="btn btn-secondary btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2014</button>
                      <div class="dropdown-menu">
                        <a class="dropdown-item" onclick="changeLayer('2014', '')">2014</a>
                        <a class="dropdown-item" onclick="changeLayer('2015', '')">2015</a>
                        <a class="dropdown-item" onclick="changeLayer('2016', '')">2016</a>
                      </div>
                    </div>

                    <div class="btn-group" role="group" aria-label="navi-policy">
                      <button id="choice_drop" class="btn btn-secondary btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">CCTV 설치대 수</button>
                      <div class="dropdown-menu">
                        <a class="dropdown-item" onclick="changeLayer('', 'CCTV 설치대 수')">CCTV 설치대 수</a>
                        <a class="dropdown-item" onclick="changeLayer('', '여성안심지킴이 집')">여성안심지킴이 집</a>
                        <a class="dropdown-item" onclick="changeLayer('', '안심귀가스카우트 이용자 수')">안심귀가스카우트 이용자 수</a>
                        <a class="dropdown-item" onclick="changeLayer('', '구별 성범죄 수')">구별 성범죄 수</a>
                      </div>
                    </div>
                  </div>
                  <p class="section_text"></p>
                </svg>
              </div>
            </div>
          </td>

          <td id="conclusion_view">
            <div class="container">
              <div class="section_header">
                <h1 class="section_title"></h1>
              </div>
              <div class="section_container">
                <svg class="section_slides">
                  <p class="section_text"></p>
                </svg>
              </div>
            </div>
          </td>
        </tr>
      </table>
    </div>

    <script type="text/javascript" src="scripts/intro_script.js"></script>
    <script type="text/javascript" src="scripts/analysis_script.js"></script>
    <script type="text/javascript" src="scripts/map_utils.js"></script>
    <script type="text/javascript" src="scripts/map_script.js"></script>
    <script>
        var statesData = {};

        d3.queue()
          .defer(d3.json, 'scripts/seoul_municipalities_geo.json')
          .defer(d3.json, 'scripts/seoul_municipalities_geo.json')
          .defer(d3.json, 'scripts/seoul_municipalities_geo.json')
          .defer(d3.csv, 'scripts/dataset.csv')
          .awaitAll(function(err, data) {
            var geos = data.slice(0, 3);
            geos.forEach(function(g) {
                g.features.sort(function(a, b) {
                    return d3.ascending(a.properties.SIG_KOR_NM, b.properties.SIG_KOR_NM);
                });
            });

            var dataset = data[3];
            var nested = d3.nest()
              .key(function(d) {return d.year;})
              .entries(dataset);
            nested.forEach(function(d, i) {
                statesData[d.key] = geos[i];
                geos[i].features.forEach(function(f, j) {
                    var d = nested[i].values[j];
                    f.properties.cctv = +d.cctv;
                    f.properties.shelter = +d.shelter;
                    f.properties.users = +d.users;
                    f.properties.crime = +d.crime;
                });
            });

            changeLayer('2014');
          });
    </script>
    <script>
        $('.pagination li').click(function(e) {
          e.preventDefault();
          var scrollTarget = document.querySelector('#' + e.currentTarget.id + '_view');
          window.scroll({
            top: 0,
            left: scrollTarget.offsetLeft,
            behavior: 'smooth'
          });
        });
    </script>
  </body>
</html>
