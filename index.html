<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Safety-First | 서울은 성범죄로부터 안전한 곳인가</title>
    <link rel="stylesheet" href="scripts/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/notosanskr.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin=""/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
  </head>
  <body>
    <svg id="background_gradient" />
    <nav class="navbar fixed-top">
      <ul class="nav nav-pills">
        <li class="nav-item"><a class="nav-link" href="#home_page">HOME</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">INTRO</a>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="#project_introduction_page">Project</a>
            <a class="dropdown-item" href="#team_introduction_page">The Team</a>
          </div>
        </li>
        <li class="nav-item"><a class="nav-link" href="#demographics_page">What About You?</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">ANALYSIS</a>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="#analysis_page">Charts</a>
            <a class="dropdown-item" href="#map_vis_page">Map Visualization</a>
            <a class="dropdown-item" href="#crime_analysis_page">Crime Data</a>
        </div>
        </li>
        <li class="nav-item"><a class="nav-link" href="#conclusion_page">CONCLUSION</a></li>
      </ul>
    </nav>

    <table id="content_wrapper">

      <td id="home_page" class="jumbotron" style="background: transparent !important;">
        <h1 class="home_page_title">Safety First</h1>
        <p class="home_page_text"><strong>서울시, 성범죄로부터 안전한가?</strong></p>
      </td>

      <td id="project_introduction_page">
        <div class="slide_backdrop"></div>
        <h1 class="page_header">About the Project</h1>
        <table>
          <td class="project_intro_section"><img class="project_intro_image" src="scripts/demographic_img/intro_icon1.png">
            <h4> 안전 서울? </h4><br>
            <p>서울의 밤길은 안전한가<br>
              받을 수 있는 도움은 무엇인가<br>
              <b>데이터로 살펴보는 안전한 서울</b></p>
            </td>
            <td class="project_intro_section"><img class="project_intro_image" src="scripts/demographic_img/intro_icon2.png">
              <h4> 분석 및 시각화 </h4><br>
              <p>요일별/시간대별/자치구별<br>
                성범죄율과 예방 정책<br>
                <b>상관관계 분석 및 시각화</b></p>
              </td>
              <td class="project_intro_section"><img class="project_intro_image" src="scripts/demographic_img/intro_icon3.png">
                <h4> All of us </h4><br>
                <p>우리가 알지 못했던 일<br>
                  그리고<br>
                  <b>우리가 할 수 있는 일</b></p>
                </td>
              </table>
            </td>

      <td id="team_introduction_page">
        <div class="slide_backdrop"></div>
        <h1 class="page_header">The Team Members</h1>
        <table class="content">
        <tbody>
          <tr style="height: 20em;">
            <td><img class="team_image align-top" src="scripts/demographic_img/team_sujin.png">
              <h2>오수진</h2>
              <p>Team Leader, Planning, Visualization<br>
              &nbsp;<br>
              &nbsp;</p>
            </td>
            <td><img class="team_image align-top" src="scripts/demographic_img/team_jihae.png">
              <h2>신지혜</h2>
              <p>Planning, Storytelling, Front-end developer<br>
                (What about You?)<br>
                &nbsp;<br>
              anne.jh.shin@gmail.com</p>
            </td>
            <td><img class="team_image align-bottom" src="scripts/demographic_img/team_hijung.png">
              <h2>정희정</h2>
              <p>Analysis, Map Visualization, Presenter<br>
              &nbsp;<br>
              jhj7347@naver.com<br>
              &nbsp;</p>
            </td>
            <td><img class="team_image align-bottom" src="scripts/demographic_img/team_eunchae.png">
              <h2>김은채</h2>
              <p>Main Front-end-developer, Planning, Web design<br>
              &nbsp;<br>
                echaekim219@gmail.com<br>
                &nbsp;</p>
            </td>
          </tr>
        </tbody>
      </table>
      </td>

      <td id="demographics_page" class="jumbotron">
        <h2>대한민국에 사는 우리들, 성범죄로부터 안전한가?</h2>
        <p class="lead">당신의 인적 사항 정보를 알려주세요.<br>
          입력된 정보와 일치하는 <u>최근 2년간 일어난 성폭력 피해자</u> 숫자를 공개합니다.<br>
        </p>
        <h6>2014~2015년 전국 성폭력 피해자 성별/연령 현황[데이터출처: 대검찰청]</h6>
        <hr class="my-4">
        <section id="question-container">
          <div id="question-gender">
            <div class="question">
              <div><strong>1. 당신의 성별은?</strong></div>
              <div class="question-navi">
                <span class="navi-current">성별</span> ➡ <span class="navi-none-age">연령</span>
              </div>
            </div>
            <div class="image-selector">
              <div class="selector-item" qtype="gender" value="여성">
                <img src="scripts/demographic_img/female.png" alt="female">
                <p>여성</p>
              </div>
              <div class="selector-item" qtype="gender" value="남성">
                <img src="scripts/demographic_img/male.png" alt="male">
                <p>남성</p>
              </div>
            </div>
          </div>
          <div id="question-age">
            <div class="question">
              <div><strong>2. 당신의 연령은?</strong></div>
              <div class="question-navi">
                <span class="navi-none-gender">성별</span> ➡ <span class="navi-current">연령</span>
              </div>
            </div>
            <div class="image-selector-age">
              <div class="selector-item" qtype="age" value="6세 이하">
                <img src="scripts/demographic_img/under12.png" alt="">
                <p>6세 이하</p>
              </div>
              <div class="selector-item" qtype="age" value="7세~12세">
                <img src="scripts/demographic_img/under12.png" alt="">
                <p>7세~12세</p>
              </div>
              <div class="selector-item" qtype="age" value="13세~15세">
                <img src="scripts/demographic_img/under20.png" alt="">
                <p>13세~15세</p>
              </div>
              <div class="selector-item" qtype="age" value="16세~20세">
                <img src="scripts/demographic_img/under20.png" alt="">
                <p>16세~20세</p>
              </div>
              <div class="selector-item" qtype="age" value="21세~30세">
                <img src="scripts/demographic_img/under40.png" alt="">
                <p>21세~30세</p>
              </div>
              <div class="selector-item" qtype="age" value="31세~40세">
                <img src="scripts/demographic_img/under40.png" alt="">
                <p>31세~40세</p>
              </div>
              <div class="selector-item" qtype="age" value="41세~50세">
                <img src="scripts/demographic_img/under40.png" alt="">
                <p>41세~50세</p>
              </div>
              <div class="selector-item" qtype="age" value="51세~60세">
                <img src="scripts/demographic_img/under50.png" alt="">
                <p>51세~60세</p>
              </div>
              <div class="selector-item" qtype="age" value="60세 초과">
                <img src="scripts/demographic_img/over51.png" alt="">
                <p>61세 이상</p>
              </div>
            </div>
          </div>
        </section>

        <section id="result-container">
          <div id="user-intro">
            나는 <span id="gender-bc" class="breadcomb">성별</span> <span id="age-bc" class="breadcomb">연령</span> 입니다.
          </div>
          <div id="result-summary">
            "당신과 같은 조건의 피해자는 <span id="victim">30463</span>명입니다"
          </div>
        </section>
        <section id="next">
        <p class="lead"><strong>최근 2년간(2014-2015년) 성폭력 피해자 상세 통계</strong>
          <a class="btn" href="more.html" role="button"><strong>더 알아보기</strong></a>
        </p>
        </section>
      </td>

      <td id="analysis_page">
        <div class="slide_backdrop" style="position: absolute; top: 20px;"></div>
        <div class="container">
          <h2 class="page_header_chart">서울시 성범죄 현황</h2>
          <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="false">
            <!-- Indicators -->
            <ol class="carousel-indicators">
              <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
              <li data-target="#myCarousel" data-slide-to="1"></li>
              <li data-target="#myCarousel" data-slide-to="2"></li>
              <li data-target="#myCarousel" data-slide-to="3"></li>
            </ol>
            <!-- Wrapper for slides -->
            <div class="carousel-inner" role="listbox">
              <div class="carousel-item active">
                <div class="chartWithOverlay">
                  <div id="pieChart1" class="chart"></div>
                  <div class="overlay analysis_text">
                    - 성범죄 중 64% 는 5대 범죄에 해당하는 “강간 및 강제추행”
                      (* 5대 범죄란? 살인, 강도, 절도, 강간, 폭력)<br>
                      - 2011년~2016년, 5년 동안 몰카 범죄 구속자수 5배로 급증<br>
                      [출처: 카메라 등을 이용한 촬영범죄 현황/법무부, 경찰청/ 2017년]
                    </div>
                  </div>
                </div>

                <div class="carousel-item">
                  <div class="chartWithOverlay">
                    <div id="line_year" class="chart"></div>
                    <div class="overlay analysis_text">
                      - 최근 3년, 서울시 성범죄 발생 건수는 큰 변화 없음<br>
                        (비교) 성폭력 10년간 117% 급증, 반면 살인·강도·방화 등 다른 흉악범죄는 뚜렷한 감소 추세<br>
                        [출처: 2016년 범죄백서/법무부 산하 법무연수원/2016년]
                      </div>
                    </div>
                  </div>

                  <div class="carousel-item">
                    <div class="chartWithOverlay">
                      <div id="line_week" class="chart"></div>
                      <div class="overlay" id="analysis_text">
                        - 요일별 성범죄 발생 순위 : 1. 금요일, 2. 토요일, 3. 화요일 (유의미하지 않은 데이터)<br>
                      </div>
                    </div>
                  </div>

                  <div class="carousel-item">
                    <div class="chartWithOverlay">
                      <div id="line_time" class="chart"></div>
                      <div class="overlay analysis_text">
                        - 시간대별 성범죄 발생 순위 : 1. 심야, 2. 초저녁, 3. 밤 (유의미한 데이터)<br>
                      </div>
                    </div>
                  </div>

                 <!-- Controls -->
                 <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
                   <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                   <span class="sr-only">Previous</span>
                 </a>
                 <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
                   <span class="carousel-control-next-icon" aria-hidden="true"></span>
                   <span class="sr-only">Next</span>
                 </a>
               </div>
             </td>

      <td id="map_vis_page">
          <svg class="slide_backdrop" />
          <h1 class="page_header">서울시 구별 현황 비교</h1>
          <table>
            <td>
              <div class="btn-group" role="group" aria-label="navi-year">
                <button id="year_drop" class="btn btn-secondary btn-md dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2014</button>
                <div class="dropdown-menu">
                  <a class="dropdown-item" onclick="changeLayer('2014', '')">2014</a>
                  <a class="dropdown-item" onclick="changeLayer('2015', '')">2015</a>
                  <a class="dropdown-item" onclick="changeLayer('2016', '')">2016</a>
                </div>
              </div>
              <div class="btn-group" role="group" aria-label="navi-policy">
                <button id="choice_drop" class="btn btn-secondary btn-md dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">CCTV 설치대 수</button>
                <div class="dropdown-menu">
                  <a class="dropdown-item" onclick="changeLayer('', 'CCTV 설치대 수')">CCTV 설치대 수</a>
                  <a class="dropdown-item" onclick="changeLayer('', '여성안심지킴이 집')">여성안심지킴이 집</a>
                  <a class="dropdown-item" onclick="changeLayer('', '안심귀가스카우트 이용자 수')">안심귀가스카우트 이용자 수</a>
                  <a class="dropdown-item" onclick="changeLayer('', '구별 성범죄 수')">구별 성범죄 수</a>
                </div>
              </div>
              <div id="map"></div>
          </td>
          <td class="map_section_text">
            -  CCTV 설치 대수 증가 : 2016년 대다수의 자치구가 CCTV 300대 이상을 보유<br>
            -  여성 안심 지킴이집 개수 증가 : 2016년 대다수의 자치구가 40곳 이상을 보유<br>
            - 안심귀가스카우트 이용자 수 증가 : 2016년 대다수의 자치구에서 만명 이상의 이용자 발생<br><br><br>
            <strong>위 변수들이 성범죄 발생률 증감에 미치는 영향은 크지 않습니다. 자치구별 다른 특징이 보다 큰 상관관계가 있는 것으로 판단됩니다.</strong>
          </td>
        </table>
      </td>


      <td id="crime_analysis_page">
        <div class="slide_backdrop" style="position: absolute; top: 20px;"></div>
        <h1 class="page_header_chart">서울시 구별 현황 비교</h1>
        <div class="chartWithOverlay">
          <div div id="barChart"></div>
          <div class="overlay">
            <div><br>
              - 요일보다는 시간대가 범죄율과 상관관계가 높다.<br>
              - 자치구와 범죄율의 상관관계만 유의미하다.<br><br>
              <h2>IDEA</h2>
              <b>- 범죄율이 가장 높은 0~4시를 위한 정책 필요<br>
              - 범죄율이 높은 자치구는 주로 유동인구가 많은 곳으로 판단되어 더 많은 대중적 관심 및 정책 필요</b></div>
            </div>
          </div>
        </td>


      <td id="conclusion_page">
        <div class="slide_backdrop" style="position: absolute; top: 20px;"></div>
        <img class="conclusion_image" src="scripts/demographic_img/conclusion.png">
      </td>
    </td>
  </tr>
</table>
</div>

    <script src="scripts/demographic_script.js"></script>
    <script src="scripts/analysis_script.js"></script>
    <script src="scripts/map_utils.js"></script>
    <script src="scripts/map_script.js"></script>
    <script src="scripts/crime_analysis_script.js"></script>
    <script>
        var statesData = {};

        d3.queue()
          .defer(d3.json, 'scripts/seoul_municipalities_geo.json')
          .defer(d3.json, 'scripts/seoul_municipalities_geo.json')
          .defer(d3.json, 'scripts/seoul_municipalities_geo.json')
          .defer(d3.csv, 'scripts/dataset.csv')
          .awaitAll(function(err, data) {
            var geos = data.slice(0, 3);
            geos.forEach(function(g) {
                g.features.sort(function(a, b) {
                    return d3.ascending(a.properties.SIG_KOR_NM, b.properties.SIG_KOR_NM);
                });
            });

            var dataset = data[3];
            var nested = d3.nest()
              .key(function(d) {return d.year;})
              .entries(dataset);
            nested.forEach(function(d, i) {
                statesData[d.key] = geos[i];
                geos[i].features.forEach(function(f, j) {
                    var d = nested[i].values[j];
                    f.properties.cctv = +d.cctv;
                    f.properties.shelter = +d.shelter;
                    f.properties.users = +d.users;
                    f.properties.crime = +d.crime;
                });
            });

            changeLayer('2014');
          });
    </script>
  </body>
</html>
